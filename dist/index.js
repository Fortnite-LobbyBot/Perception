// @bun
var r;(function(t){t["Default"]="en";t["De"]="de";t["Es"]="es";t["Fr"]="fr";t["It"]="it";t["Pl"]="pl";t["Pt"]="pt";t["Tr"]="tr"})(r||(r={}));class n{lockPromise;constructor(){this.lockPromise=void 0}get isLocked(){return!!this.lockPromise}wait(){return this.lockPromise?.promise||Promise.resolve()}lock(){let e;const o=new Promise((c)=>{e=c});this.lockPromise={promise:o,resolve:e}}unlock(){this.lockPromise?.resolve(),this.lockPromise=void 0}}class a{moduleObject;locale;options;constructor(e,o,c){this.moduleObject=e,this.locale=o,this.options=c}translate(e,o){return this.moduleObject?.[e]?.replace(/{(.*?)}/gi,(i,s)=>{return o?.[s]??""})??`TRANSLATION_ERROR: LOCALE "${this.locale}" KEY "${e}" MODULE "${this.options.module}"`}}class p{localeObject;locale;constructor(e,o){this.localeObject=e,this.locale=o}createTranslator(e){return new a(this.localeObject?.[e.module],this.locale,e)}}var d="https://cdn.fnlb.net";class f{scope;contextCache={};loadCache={};constructor(e){this.scope=e}async getContext(e,o){const c=`${e}/${o}.json`,i=this.contextCache[c];if(i)return i;const s=this.loadCache[c];if(!s){const l=new n;l.lock(),this.loadCache[c]=l;const u=await fetch(`${d}/locales/${this.scope}/${c}`).then((t)=>t.json().catch(()=>null)).catch(()=>null);if(!u)return;const m=new p(u,o);return this.contextCache[c]=m,l.unlock(),m}if(s?.isLocked)await s.wait();return this.contextCache[c]}static transformToSupportedLocale(e){if(typeof e!=="string")return r.Default;const o=e.split("-")[0]?.toLowerCase();if(Object.values(r).includes(o))return o;return r.Default}}export{r as Locales,a as LocaleTranslator,p as LocaleContext,f as LocaleClient};
